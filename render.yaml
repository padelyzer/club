# render.yaml - Configuraci칩n para Deploy Autom치tico
# Este archivo permite deployar todos los servicios con un click

services:
  # Backend Django API
  - type: web
    name: padelyzer-backend
    runtime: python
    repo: https://github.com/tu-usuario/padelyzer # Cambiar a tu repo
    branch: main
    rootDir: backend
    buildCommand: "./build.sh"
    startCommand: "gunicorn config.wsgi:application"
    envVars:
      - key: PYTHON_VERSION
        value: 3.9.19
      - key: SECRET_KEY
        generateValue: true
      - key: DJANGO_SETTINGS_MODULE
        value: config.settings.production
      - key: DATABASE_URL
        fromDatabase:
          name: padelyzer-db
          property: connectionString
      - key: REDIS_URL
        fromService:
          name: padelyzer-redis
          type: redis
          property: connectionString
    
  # Frontend Next.js (Static)
  - type: web
    name: padelyzer-frontend  
    runtime: static
    repo: https://github.com/tu-usuario/padelyzer # Cambiar a tu repo
    branch: main
    rootDir: frontend
    buildCommand: "npm install && npm run build && npm run export"
    staticPublishPath: ./out
    envVars:
      - key: NEXT_PUBLIC_API_URL
        fromService:
          name: padelyzer-backend
          type: web
          property: host
      - key: NEXT_PUBLIC_APP_NAME
        value: Padelyzer
    headers:
      - path: /*
        name: X-Frame-Options
        value: SAMEORIGIN

databases:
  # PostgreSQL Database
  - name: padelyzer-db
    plan: free # o "starter" para producci칩n
    databaseName: padelyzer
    user: padelyzer

# Redis (opcional para cache)
services:
  - type: redis
    name: padelyzer-redis
    plan: free # o "starter" para producci칩n
    maxmemoryPolicy: allkeys-lru